<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quotation Estimations</title>
    <link rel="stylesheet" href="css/style.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet">

    <style>
.card-img-top {
	width: 100%;
height: 25vh;
					object-fit: cover;
				}

        input:invalid {
    border: 1px solid red;
}

/* Style for valid inputs */
input:valid {
    border: 1px solid green;
}
</style>
  </head>

  <body>

    <div class="container">
      <div class="row justify-content-center">
        <div class="col p-2">
          <h1 style="font-size:3vw">Average Cost of Construction</h1>
        </div>
      </div>
      <form id="form" class="row g-3 needs-validation" novalidate>
        <div class="page row">
          <div class="col-md-6">
            <label for="totalLotArea" class="form-label">Total Lot Area
              (sq.m.)</label>
            <input type="number" class="form-control" id="totalLotArea"
              name="totalLotArea" min="1" required>
            <div class="invalid-feedback">Please enter the total lot area.</div>
          </div>
          <div class="col-md-6">
            <label for="totalFloorArea" class="form-label">Total Floor Area
              (sq.m.)</label>
            <input type="number" class="form-control" id="totalFloorArea"
              name="totalFloorArea" min="1" required>
            <div class="invalid-feedback">Please enter the total floor
              area.</div>
          </div>
          <div class="col-md-6">
            <label for="numberOfFloors" class="form-label">Number of
              Floors</label>
            <input type="number" class="form-control" id="numberOfFloors"
              name="numberOfFloors" min="1" required>
            <div class="invalid-feedback">Please enter the number of
              floors.</div>
          </div>
          <div class="col-md-6">
            <label for="numberOfBathrooms" class="form-label">Number of
              Bathrooms</label>
            <input type="number" class="form-control" id="numberOfBathrooms"
              name="numberOfBathrooms" min="1" required>
            <div class="invalid-feedback">Please enter the number of
              bathrooms.</div>
          </div>
          <div class="col-md-6">
            <label
              for="numberOfRooms"
              class="form-label">Number of Rooms</label>

            <input
              type="number"
              class="form-control"
              id="numberOfRooms"
              name="numberOfRooms" min="1" required>
            <div class="invalid-feedback">Please enter the number of
              rooms.</div>
          </div>

          <div
            class="col-12">

            <button
              type="submit"
              class="btn btn-primary next-button">Submit</button>

          </div>
        </div>
      </form>
    </div>

    <footer class="footer">
      <div class="container text-center">
        <span>&copy; All Right Reserved 2023</span>
      </div>
    </footer>

    <!--code end here-->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
      integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.min.js"
      integrity="sha512-WW8/jxkELe2CAiE4LvQfwm1rajOS8PHasCCx+knHG0gBHt8EXxS6T6tJRTGuDQVnluuAvMxWF4j8SNFDKceLFg=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/6.0.0/bootbox.min.js"
      integrity="sha512-oVbWSv2O4y1UzvExJMHaHcaib4wsBMS5tEP3/YkMP6GmkwRJAa79Jwsv+Y/w7w2Vb/98/Xhvck10LyJweB8Jsw=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"
      integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- <script
      src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
    <script
      src="https://www.gstatic.com/firebasejs/8.6.1/firebase-auth.js"></script>
    <script
      src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js"></script> -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, addDoc, collection } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries
      
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
          apiKey: "AIzaSyCSW7UMHtJDdRJga5oSEHgppvUsLRtagx0",
          authDomain: "jt25-fae27.firebaseapp.com",
          projectId: "jt25-fae27",
          storageBucket: "jt25-fae27.appspot.com",
          messagingSenderId: "590615766263",
          appId: "1:590615766263:web:95dc99f6487ba0693a1ff2",
          measurementId: "G-QB2Z7JDN2V"
        };
      
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        var currentPage = 0;
        var pages = $('.page');
        var maxPage = pages.length;
        const totalLotArea = $('#totalLotArea');
        const totalFloorArea = $('#totalFloorArea');
        const numberOfFloors = $('#numberOfFloors');
        const numberOfBathrooms = $('#numberOfBathrooms');
        const numberOfRooms = $('#numberOfRooms');

        const form = document.querySelector('.needs-validation');
        form.addEventListener('submit', async (event) => {
          event.preventDefault(); // Prevent default form submission

          // Validate form fields
          if (form.checkValidity() === false) {
            event.stopPropagation();
            form.classList.add('was-validated'); // Show validation errors
            return;
          }

          let formError = isFormValid();
          if(formError.length > 0){
            bootbox.alert(formError);
            return;
          }

          // Collect form data
          const propertyData = {
            totalLotArea: parseInt(document.getElementById('totalLotArea').value),
            totalFloorArea: parseInt(document.getElementById('totalFloorArea').value),
            numberOfFloors: parseInt(document.getElementById('numberOfFloors').value),
            numberOfBathrooms: parseInt(document.getElementById('numberOfBathrooms').value),
            numberOfRooms: parseInt(document.getElementById('numberOfRooms').value),
          };

          // Add Firestore validation here
          // ... (see next step)

          // Add a new document with a generated id.
          const docRef = await addDoc(collection(db, "properties"), propertyData);
          console.log("Document written with ID: ", docRef.id);
        });


        function isFormValid(){
          if(totalFloorArea.val() > totalLotArea.val()){
            return `Total Lot Area must be larger than floor area!`;
          }
          return '';
        }
    </script>
    <script>
      
  $(function(){    
    $.get("navbar.html", function(data) {
      $("body").prepend(data); // Append content.html data into the #container div
    });

    
    
  });
</script>

  </body>
</html>
